<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>


<!-- Bootstrap Core CSS -->
<link href="../css/bootstrap.css" rel='stylesheet' type='text/css' />

<!-- Custom CSS -->
<link href="../css/style.css" rel='stylesheet' type='text/css' />

<!-- font-awesome icons CSS -->
<link href="../css/font-awesome.css" rel="stylesheet"> 
<!-- //font-awesome icons CSS-->

<!-- side nav css file -->
<link href='../css/SidebarNav.min.css' media='all' rel='stylesheet' type='text/css'/>
<!-- //side nav css file -->
 
 <!-- js-->
<script src="../js/jquery-1.11.1.min.js"></script>
<script src="../js/modernizr.custom.js"></script>

<!--webfonts-->
<link href="http://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet">
<!--//webfonts--> 

<!-- chart -->
<script src="../js/Chart.js"></script>
<!-- //chart -->

<!-- Metis Menu -->
<script src="../js/metisMenu.min.js"></script>
<script src="../js/custom.js"></script>
<link href="../css/custom.css" rel="stylesheet">
<!--//Metis Menu -->

<!--pie-chart --><!-- index page sales reviews visitors pie chart -->
<script src="../js/pie-chart.js" type="text/javascript"></script>
<link href="../assets/drag/bootstrap-3.3.7/bootstrap/css/bootstrap.css" rel="stylesheet">

<link  href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet"/>
<script src="../assets/vendor/toastr/toastr.min.js"></script>


</head> 
<body class="cbp-spmenu-push" style="width:100%;">
<div class="sticky-header header-section " th:replace="head::head">	</div>
<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" th:replace="menu::menu">	</div>	
		<div id="page-wrapper" >
			<div id="accordion-magical-coder-auto-id-1564366418619" class="panel-group" role="tablist" aria-multiselectable="true" style="margin-top: 20px; margin-left: 25px; margin-right: 25px;">
				<div class="panel panel-default">
					<div class="panel-heading" role="tab">
						<h4 class="panel-title">
							<a role="button" data-toggle="collapse" data-parent="#accordion-magical-coder-auto-id-1564366418619" href="#collapseOne-magical-coder-auto-id-15643425313" aria-expanded="true" class="">业务参数配置 Business parameter configuration</a>
						</h4>
					</div>
					<div id="collapseOne-magical-coder-auto-id-1564366425313" class="panel-collapse collapse in" role="tabpanel" aria-expanded="true">
						<div class="panel-body" style="height: auto;">
						<form action="">
							<div class="table-responsive">
								<table class="table">
									<thead>
										<tr class="">
											<th style="width: 5%;">编号</th>
											<th class="" style="width: 35%;">参数 parameter name</th>
											<th class="" style="width:10%;">当前值 value</th>
											<th class="" style="width:10%;">生效时间 enableDate</th>
											<th class="" style="width:10%;">预设值 value</th>
											<th class="" style="width:10%;">生效时间 enableDate</th>
											<th class="" style="width:10%;">失效值 value</th>
											<th class="" style="width:10%;">生效时间 enableDate</th>
											<th class="" style="width:20%;">操作 operation</th>
										</tr>
									</thead>
									<tbody>
										<th:block th:if="${parameters != null}">
										<tr th:each="setting,paramStart: ${parameters}">
											<td th:text="${paramStart.count}">1</td>
											<td th:text="${setting?.comment}" value="${setting?.comment}">48</td>
											<td th:text="${setting?.sValue}" value="${setting?.sValue}">48</td>
											<td th:text="${#dates.format(setting?.enableDate,'yyyy-MM-dd')}"></td>
											<td th:text="${setting?.afterValue}" value="${setting?.afterValue}">48</td>
											<td th:text="${#dates.format(setting?.afterEnableDate,'yyyy-MM-dd')}"></td>
											<td th:text="${setting?.preValue}" value="${setting?.preValue}">48</td>
											<td th:text="${#dates.format(setting?.preEnableDate,'yyyy-MM-dd')}"></td>
											<td>
											<i class="glyphicon glyphicon-pencil"></i>
											<a href="" class="update" th:title="${setting.id}"> edit</a>
				                                <!-- <button type="button" class="btn btn-primary btn-lg update"  th:title="${setting.id}" style="font-size: 10px; padding: 3px 10px;">
				                                    		操作 edit
				                                </button> -->
											</td>
										</tr>
									</th:block>
									</tbody>
								</table>
							</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	<div id="footer" class="container" th:replace="foot::foot"></div>
	
<script src="../js/classie.js"></script>
<script>
	var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
		showLeftPush = document.getElementById( 'showLeftPush' ),
		body = document.body;
		
	showLeftPush.onclick = function() {
		classie.toggle( this, 'active' );
		classie.toggle( body, 'cbp-spmenu-push-toright' );
		classie.toggle( menuLeft, 'cbp-spmenu-open' );
		disableOther( 'showLeftPush' );
	};
	

	function disableOther( button ) {
		if( button !== 'showLeftPush' ) {
			classie.toggle( showLeftPush, 'disabled' );
		}
	}
	
	
	var ctxPath  = [[@{/}]];
	      $(function(){
	    	  $(".update").on("click",function(){
		  			var comment=$(this).parent().siblings("td:eq(1)").text();
		  			var sValue=$(this).parent().siblings("td:eq(2)").text();
		  			var enableDate=$(this).parent().siblings("td:eq(3)").text();
		  			var code= $(this).attr("title");
		  			
		  			$(".settingform .code").val(code);
		  			$(".settingform .comment").val(comment);
		  			$(".settingform .sValue").val(sValue);
		  			$(".settingform .enableDate").val(enableDate);
		  			
		    	  });
	    	  
	    	  $(".settingform").on("submit",function(e){
	    		  e.preventDefault();
	    		  var url=ctxPath+"parameterSetting/update";
	    		  var code=$(".settingform .code").val();  		  
	    		  var comment=$(".settingform .comment").val(); 
	    		  var sValue=$(".settingform .sValue").val(); 
	    		  var enableDate=$(".settingform .enableDate").val(); 
	    		
	    		  var data={
	    				  code:code,
	    				  comment:comment,
	    				  sValue:sValue,
	    				  enableDate:enableDate
	    				  }
	    		  $.ajax(
	    		      		{type:"POST",
	    		      		   url: url,
	    		      		   contentType:'application/json;charset=utf-8',
	    		      		   data:JSON.stringify(data),
	    		      		   success: function(data){	  
	    		      			 showmsg(data);	     
	    		      		   },
	    		      		  error: function (xhr) {
	    		      	        console.log(xhr);
	    		      	    } });
	    	     });
	    	  
	    	  $(".update").on("click",function(){
	    		  var id= $(this).attr("title");
	    	      window.location.href = ctxPath+"parameterSetting/toUpdate?id="+id; 
	    	      return false;
	          });
	    	  
	          });
	      
		      function showmsg(data){
		    	  if(data.status>200){
				    	toastr.warning(data.msg);  
				       }
				    else{
				    	toastr.success(data.msg);
				      }
				 setTimeout(function(){
					window.location.reload();	      				 
				    },1000);
		      }
		      
		      toastr.options = {  
	    	        closeButton: false,  
	    	        debug: false,  
	    	        progressBar: false,  
	    	        positionClass: "toast-bottom-center",  
	    	        onclick: null,  
	    	        showDuration: "300",  
	    	        hideDuration: "1000",  
	    	        timeOut: "2000",  
	    	        extendedTimeOut: "1000",  
	    	        showEasing: "swing",  
	    	        hideEasing: "linear",  
	    	        showMethod: "fadeIn",  
	    	        hideMethod: "fadeOut"  
	    	    }; 
</script>	
<!--scrolling js-->
<script src="../js/jquery.nicescroll.js"></script>
<script src="../js/scripts.js"></script>
<!--//scrolling js-->

<!-- side nav js -->
<script src='../js/SidebarNav.min.js' type='text/javascript'></script>
<script>
     $('.sidebar-menu').SidebarNav()
   </script>	
<script src="../js/SimpleChart.js"></script>
<script src="../js/bootstrap.js"> </script>	
   
<!--  js -->  
</body>
</html>