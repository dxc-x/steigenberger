<!DOCTYPE HTML>
<html>
<head>
<title>Home</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>

<!-- Bootstrap Core CSS -->
<link href="../css/bootstrap.css" rel='stylesheet' type='text/css' />

<!-- Custom CSS -->
<link href="../css/style.css" rel='stylesheet' type='text/css' />

<!-- font-awesome icons CSS -->
<link href="../css/font-awesome.css" rel="stylesheet"> 
<!-- //font-awesome icons CSS-->

<!-- side nav css file -->
<link href='../css/SidebarNav.min.css' media='all' rel='stylesheet' type='text/css'/>
<!-- //side nav css file -->
 
 <!-- js-->
<script src="../js/jquery-1.11.1.min.js"></script>
<script src="../js/modernizr.custom.js"></script>

<!--webfonts-->
<link href="http://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet">
<!--//webfonts--> 

<!-- chart -->
<script src="../js/Chart.js"></script>
<!-- //chart -->

<!-- Metis Menu -->
<script src="../js/metisMenu.min.js"></script>
<script src="../js/custom.js"></script>
<link href="../css/custom.css" rel="stylesheet">
<!--//Metis Menu -->

<!--pie-chart --><!-- index page sales reviews visitors pie chart -->
<script src="../js/pie-chart.js" type="text/javascript"></script>
<link href="../assets/drag/bootstrap-3.3.7/bootstrap/css/bootstrap.css" rel="stylesheet">

<link  href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet"/>
<script src="../assets/vendor/toastr/toastr.min.js"></script>
 
</head> 
<body class="cbp-spmenu-push" style="width:100%;">
	<div class="sticky-header header-section " th:replace="head::head">	</div>
<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" th:replace="menu::menu">	</div>	

		<!-- //header-ends -->
		<!-- main content start-->
		
		<div id="page-wrapper" >
			<div id="accordion-magical-coder-auto-id-1564457277922" class="panel-group" role="tablist" aria-multiselectable="true" style="margin-top: 20px; margin-left: 25px; margin-right: 25px;">
    <div class="panel panel-default">
        <div class="panel-heading" role="tab">
            <h4 class="panel-title">
                <a role="button" data-toggle="collapse" href="#collapseOne-magical-coder-auto-id-1564457285983" aria-expanded="true" class="" mc-ace="~">用户查询 User query</a>
            </h4>
        </div>
        <div id="collapseOne-magical-coder-auto-id-1564457285983" class="panel-collapse collapse in" role="tabpanel" aria-expanded="true">
            <div class="panel-body" style="height: auto;">
				<form action="">
					 <div class="row">
	                    <div class="col-md-3 col-xs-3">
	                       	 用户名称 user name
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        	用户邮箱 user main
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        	角色 role
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        	状态 status
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        <input type="text" class="form-control searchVal1" id="searchVal1" th:value="${user1?.userName}">
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        <input type="text" class="form-control searchVal2" id="searchVal2" th:value="${user1?.userMail}">
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                    
	                        <select class="form-control  searchVal3" name="" th:value="${user1?.rolesName}">
									<option value="">全选</option>
	                        		<option  th:each="role:${roleList}" th:value="${role.id}" th:text="${role.name}" th:selected="${user1.rolesName eq role.id}"></option>
								</select>
	                    </div>
	                    <div class="col-md-3 col-xs-3">
	                        <select class="form-control  searchVal4" name="" th:value="${user1?.isActive}">
	                        		<option value="2">全选</option>
									<option value="1" th:selected="${user1?.isActive }==1">启用</option>
									<option value="0" th:selected="${user1?.isActive }==0">停用</option>
								</select>
	                    </div>
						<div class="col-md-3 col-xs-3">
	                        
	                    </div>
	                </div>
				</form>
               
                <button type="button" class="btn btn-primary" id="btn_select" style="margin-top: 10px; margin-right: 20px;">查询select</button><button type="button" id="btn_reset" class="btn btn-primary" style="margin-top: 10px; margin-right: 20px;">重置reset</button>
            </div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading" role="tab">
            <h4 class="panel-title">
                <a class="" role="button" data-toggle="collapse" href="#collapseTwo-magical-coder-auto-id-1564457283858" aria-expanded="true">用户列表 List of users</a>
            </h4>
        </div>
        <div id="collapseTwo-magical-coder-auto-id-1564457283858" class="panel-collapse collapse in" role="tabpanel" aria-expanded="true">
            <div class="panel-body" style="height: auto;">

                <div class="table-responsive">
                    <table class="table">
                        <thead>
							<tr>
								<th>编号</th>
								<th>用户名</th>
								<th>邮箱</th>
								<th>域账号</th>
								<th>角色</th>
								<th>区域</th>
								<th>账号状态</th>
								<th>操作</th>
							</tr>
						</thead>
                        <tbody>
							<th:block th:if="${pageInfo.list != null}">
								<tr th:each="user,userStart: ${pageInfo.list}">
									<td th:text="${userStart.count}">560001</td>
									<td th:text="${user.userName}">Bangalore</td>
									<td th:text="${user.userMail}">Bangalore</td>
									<td th:text="${user.userIdentity}">560001</td>
									<td th:text="${user.rolesName}">Bangalore</td>
									<td th:text="${user.region}">Bangalore</td>
									<td th:text="${user.isActive>0?'启用' :'禁用'}" th:style="${user.isActive>0?'color:green' :'color:red'}">560001</td>
									<td>
									<!-- <a class="update" th:href="@{/user/update(id=${user?.id})}"  style="color: green;margin-right:20px;" th:title="${user.id}">
											<i class="glyphicon glyphicon-refresh"></i>编辑</a>  -->
											<button type="button" class="btn btn-primary btn-lg update" data-toggle="modal"  th:title="${user.id}"
											data-target="#magicalcoderMyModal-magical-coder-auto-id-1564365300654" style="font-size: 10px; padding: 3px 10px;">
		                                    		编辑 edit
		                                </button>
									</td>
								</tr>
							</th:block>
						</tbody>
                    </table>
                </div>
				<nav aria-label="分页" class="pull-right">
                    <ul class="pagination">
                        <li>
                            <a href="#" aria-label="上一页">
                                <span aria-hidden="true">«</span>
                            </a>
                        </li>
                        <li class="disabled"><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li class="active"><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                        <li>
                            <a href="#" aria-label="下一页">
                                <span aria-hidden="true">»</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
		</div>
<div id="footer" class="container" th:replace="foot::foot"></div>
 
 <div class="modal fade" id="magicalcoderMyModal-magical-coder-auto-id-1564365300654" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="display: none;">
                                    <div class="modal-dialog" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true" class="">×</span></button>
                                                <h4 class="modal-title" id="myModalLabel">编辑 Editing the role</h4>
                                            </div>
                                            <div class="modal-body">
                                                <form action="" method="post" class="form userform">
		                                            <div class="form-group">
															<input type="number" class="form-control id hidden">
														</div>
													<div class="form-group">
														<input type="number" class="form-control id hidden">
													</div>
													<div class="form-group">
														<label for="name">用户名</label> 
														<input type="text" class="form-control userName" name="userName" placeholder="请输入名称">
													</div>
													
													<div class="form-group">
													<label for="name">角色</label>
														<div class="input-group">
															<select class="form-control  rolesName" name="" >
								                        		<option  th:each="role:${roleList}" th:value="${role.id}" th:text="${role.name}"></option>
															</select>
														</div>
													</div>
													<div class="form-group">
														<label for="name">状态</label>
														<div class="input-group">
															<select class="form-control  isActive" name="isActive">
																<option value="0" >停用</option>
																<option value="1" >启用</option>
															</select>
														</div>
													</div>
													
													<div class="form-group">
														<label for="name">邮箱</label> 
														<input type="text" class="form-control userMail" name="userMail" placeholder="" disabled="disabled">
													</div>
													<div class="form-group">
														<label for="name">域账号</label> 
														<input type="text" class="form-control userIdentity" name="userIdentity" placeholder="" disabled="disabled">
													</div>
													<div class="form-group">
														<label for="name">区域</label> 
														<input type="text" class="form-control region" name="region" placeholder="" disabled="disabled">
													</div>
													
													<div class="form-group text-righ">
														<button type="submit" class="submit btn btn-primary pull-right ">保存</button>
													</div>
													<div class="clearfix"></div>
												</form>
                                        </div>
                                    </div>
                                </div>   
	
<script src="../js/classie.js"></script>
<script>
	var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
		showLeftPush = document.getElementById( 'showLeftPush' ),
		body = document.body;
		
	showLeftPush.onclick = function() {
		classie.toggle( this, 'active' );
		classie.toggle( body, 'cbp-spmenu-push-toright' );
		classie.toggle( menuLeft, 'cbp-spmenu-open' );
		disableOther( 'showLeftPush' );
	};
	

	function disableOther( button ) {
		if( button !== 'showLeftPush' ) {
			classie.toggle( showLeftPush, 'disabled' );
		}
	}
	
	
	var ctxPath  = [[@{/}]];
	      $(function(){
	    	  $(".update").on("click",function(){
	    		 	var id= $(this).attr("title");
		  			var userName=$(this).parent().siblings("td:eq(1)").text();
		  			var userMail=$(this).parent().siblings("td:eq(2)").text();
		  			var userIdentity=$(this).parent().siblings("td:eq(3)").text();
		  			var rolesName=$(this).parent().siblings("td:eq(4)").text();
		  			var region=$(this).parent().siblings("td:eq(5)").text();
		  			var isActive=$(this).parent().siblings("td:eq(6)").text();
		  			$(".userform .id").val(id);
		  			$(".userform .userName").val(userName);
		  			$(".userform .userMail").val(userMail);
		  			$(".userform .userIdentity").val(userIdentity);
		  			$(".userform .region").val(region);
		  			$(".userform .rolesName").val(rolesName);
		  			if(isActive=="启用"){
		  				$(".userform .isActive").val(1); 
		  			}else{
		  				$(".userform .isActive").val(0);
		  			}
		  			
		    	  });
	    	  
	    	  $(".userform").on("submit",function(e){
	    		  e.preventDefault();
	    		  var url=ctxPath+"user/update";
	    		  var id=null;
	    		  if($(".userform .id").val()!=null){
	    			 id=parseInt($(".userform .id").val());
	    		     }    		  
	    		  var userName=$(".userform .userName").val(); 
	    		  var userMail=$(".userform .userMail").val(); 
	    		  var userIdentity=$(".userform .userIdentity").val(); 
	    		  var region=$(".userform .region").val(); 
	    		  var rolesName=$(".userform .rolesName").val();
	    		  var isActive=$(".userform .isActive").val();
	    		
	    		  var data={
	    				  id:id,
	    				  rolesName:rolesName,
	    				  userName:userName,
	    				  isActive:isActive,
	    				  region:region,
	    				  userIdentity:userIdentity,
	    				  userMail:userMail,
	    				  rolesName:rolesName
	    				  }
	    		  $.ajax(
	    		      		{type:"POST",
	    		      		   url: url,
	    		      		   contentType:'application/json;charset=utf-8',
	    		      		   data:JSON.stringify(data),
	    		      		   success: function(data){	  
	    		      			 showmsg(data);	     
	    		      		   },
	    		      		  error: function (xhr) {
	    		      	        console.log(xhr);
	    		      	    } });
	    	     });
	    	  
		    	  $("#btn_select").on("click",function(){
		    	      var userName=$(".searchVal1").val();
		    	      var userMail=$(".searchVal2").val();
		    	      var rolesName=$(".searchVal3").val();
		    	      var isActive=$(".searchVal4").val();
		    	      window.location.href = ctxPath+"user/index?userMail="+userMail+"&rolesName="+rolesName+"&isActive="+isActive+"&userName="+userName; 
		    	      return false;
		          });
	    	  
	          });
	      
		      $("#btn_reset").on("click",function(){
			      $(".searchVal1").val('');
			      $(".searchVal2").val('');
			      $(".searchVal3").val('');
			      $(".searchVal4").val(2);
			      return false;
		      });
	      
	       
		      function showmsg(data){
		    	  if(data.status>200){
				    	toastr.warning(data.msg);  
				       }
				    else{
				    	toastr.success(data.msg);
				      }
				 setTimeout(function(){
					window.location.reload();	      				 
				    },1000);
		      }
		      
		      toastr.options = {  
		    	        closeButton: false,  
		    	        debug: false,  
		    	        progressBar: false,  
		    	        positionClass: "toast-bottom-center",  
		    	        onclick: null,  
		    	        showDuration: "300",  
		    	        hideDuration: "1000",  
		    	        timeOut: "2000",  
		    	        extendedTimeOut: "1000",  
		    	        showEasing: "swing",  
		    	        hideEasing: "linear",  
		    	        showMethod: "fadeIn",  
		    	        hideMethod: "fadeOut"  
		    	    }; 
</script>	
<!--scrolling js-->
<script src="../js/jquery.nicescroll.js"></script>
<script src="../js/scripts.js"></script>
<!--//scrolling js-->

<!-- side nav js -->
<script src='../js/SidebarNav.min.js' type='text/javascript'></script>
<script>
     $('.sidebar-menu').SidebarNav()
   </script>	
<script src="../js/SimpleChart.js"></script>
<script src="../js/bootstrap.js"> </script>	
   
<!--  js -->  
<script src="../pageJs/userManage.js"></script>
</body>
</html>