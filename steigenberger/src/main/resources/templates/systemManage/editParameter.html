<!DOCTYPE HTML>
<html>
<head>
	<title>Home</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="" />
	<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
	
	<!-- Bootstrap Core CSS -->
	<link href="../css/bootstrap.css" rel='stylesheet' type='text/css' />
	
	<!-- Custom CSS -->
	<link href="../css/style.css" rel='stylesheet' type='text/css' />
	
	<!-- font-awesome icons CSS -->
	<link href="../css/font-awesome.css" rel="stylesheet"> 
	<!-- //font-awesome icons CSS-->
	
	<!-- side nav css file -->
	<link href='../css/SidebarNav.min.css' media='all' rel='stylesheet' type='text/css'/>
	<!-- //side nav css file -->
	 
	 <!-- js-->
	<script src="../js/jquery-1.11.1.min.js"></script>
	<script src="../js/modernizr.custom.js"></script>
	
	<!--webfonts-->
	<link href="http://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet">
	<!--//webfonts--> 
	
	<!-- chart -->
	<script src="../js/Chart.js"></script>
	<!-- //chart -->
	
	<!-- Metis Menu -->
	<script src="../js/metisMenu.min.js"></script>
	<script src="../js/custom.js"></script>
	<link href="../css/custom.css" rel="stylesheet">
	<!--//Metis Menu -->
	
	<!--pie-chart --><!-- index page sales reviews visitors pie chart -->
	<script src="../js/pie-chart.js" type="text/javascript"></script>
	<link href="../assets/drag/bootstrap-3.3.7/bootstrap/css/bootstrap.css" rel="stylesheet">
	
	<link  href="../assets/vendor/toastr/toastr.min.css" rel="stylesheet"/>
	<script src="../assets/vendor/toastr/toastr.min.js"></script>
	
	<!-- -date -->
	<!-- <script rel="stylesheet" src="../bootstrap-date/build/js/jquery-3.3.1.min.js"></script> -->
	<script type="text/javascript" src="../bootstrap-date/build/js/moment-with-locales.min.js"></script>
	<link rel="stylesheet" href="../bootstrap-date/build/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="../bootstrap-date/build/css/bootstrap-datetimepicker.min.css"/>
	<script type="text/javascript" src="../bootstrap-date/build/js/bootstrap-datetimepicker.min.js" ></script>
	<script type="text/javascript" src="../bootstrap-date/build/js/bootstrap.min.js" ></script>
	
	
	<script type="text/javascript">
	$(function () {
	    var picker1 = $('#datetimepicker1').datetimepicker({
	        format: 'YYYY-MM-DD',
	        locale: moment.locale('zh-cn')
	        //minDate: new Date()
	    });
	   /*  var picker2 = $('#datetimepicker2').datetimepicker({
	        format: 'YYYY-MM-DD',
	        locale: moment.locale('zh-cn')
	    });
	    //动态设置最小值
	    picker1.on('dp.change', function (e) {
	        picker2.data('DateTimePicker').minDate(e.date);
	    });
	    //动态设置最大值
	    picker2.on('dp.change', function (e) {
	        picker1.data('DateTimePicker').maxDate(e.date);
	    }); */
	    
	    $(".settingform #btn_back").on("click",function(e){
			  window.location.href = ctxPath+"parameterSetting/index";	
		    });
	});
	</script>
 
</head> 
<body class="cbp-spmenu-push" style="width:100%;">
	<div class="sticky-header header-section " th:replace="head::head">	</div>
	<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" th:replace="menu::menu">	</div>	
	<div id="page-wrapper" >
		<div id="accordion-magical-coder-auto-id-1564457277922" class="panel-group" role="tablist" aria-multiselectable="true" style="margin-top: 20px; margin-left: 25px; margin-right: 25px;">
		    <div class="panel panel-default">
		        <div class="panel-heading" role="tab">
		            <h4 class="panel-title">
		                <a role="button" data-toggle="collapse" href="#collapseOne-magical-coder-auto-id-1564457285983" aria-expanded="true" class="" mc-ace="~">编辑参数 edit settings</a>
		            </h4>
		        </div>
		        <div id="collapseOne-magical-coder-auto-id-1564457285983" class="panel-collapse collapse in" role="tabpanel" aria-expanded="true">
		            <div class="panel-body" style="height: auto;">
						<form action="" class="form settingform">
								 <input type="test" class="form-control id hidden"  th:value="${parameter.id}" />
								 <input type="test" class="form-control code hidden"  th:value="${parameter?.code}" />
								 <input type="test" class="form-control old_sValue hidden"  th:value="${parameter?.sValue}" />
								 <input type="test" class="form-control old_enableDate hidden"  th:value="${parameter?.enableDate}" />
								 <div class="row">
					                    <div class="col-md-12 col-xs-12">
					                       	 参数  comment
					                    </div>
					                    <div class="col-md-12 col-xs-12">
					                        <input type="text" class="form-control comment"  th:value="${parameter?.comment}" disabled="disabled"/>
					                    </div>
				                   </div>
				                   <div class="row">
					                    <div class="col-md-12 col-xs-12">
					                        	预设值
					                    </div>
					                    <div class="col-md-12 col-xs-12">
					                        <input type="text" class="form-control sValue"  th:value="${parameter?.sValue}" />
					                    </div>
				                    </div>
				                    <div class="row">
					                    <div class="col-md-12 col-xs-12">
					                        	生效日期 
					                    </div>
					                    
					                     <div class="col-md-12 col-xs-12">
					                     <div class='input-group date' id='datetimepicker1'>
								               <input type='text' class="form-control  enableDate" name="enableDate" th:value="${parameter?.enableDate}"/>
								               <span class="input-group-addon">
								                   <span class="glyphicon glyphicon-calendar"></span>
								               </span>
								           </div> 
					                    </div>
				                    </div>
				                    <div class="row">
										<div class="form-group text-righ">
											<button type="submit" class="submit btn btn-primary" style="font-size: 15px; padding: 3px 10px;float:right;margin-right:15px" >保存</button>
											<button type="button" class="btn btn-primary" id="btn_back" style="font-size: 15px; padding: 3px 10px; float:right;margin-right:3px">返回</button>
										</div>
				                </div>
						</form>
		            </div>
		        </div>
		    </div>
		</div>
	</div>
		
		
		
	<!-- new added graphs chart js-->
	<div id="footer" class="container" th:replace="foot::foot"></div>
		
	<script src="../js/classie.js"></script>
	
	<script>
		var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
		showLeftPush = document.getElementById( 'showLeftPush' ),
		body = document.body;
		
		showLeftPush.onclick = function() {
			classie.toggle( this, 'active' );
			classie.toggle( body, 'cbp-spmenu-push-toright' );
			classie.toggle( menuLeft, 'cbp-spmenu-open' );
			disableOther( 'showLeftPush' );
		};
		
		
		function disableOther( button ) {
			if( button !== 'showLeftPush' ) {
				classie.toggle( showLeftPush, 'disabled' );
			}
		}
	
		var ctxPath  = [[@{/}]];
		$(".settingform").on("submit",function(e){
			var url=ctxPath+"parameterSetting/update";
			  var id=$(".settingform .id").val();  		  
			  var code=$(".settingform .code").val();  		  
			  var comment=$(".settingform .comment").val(); 
			  var sValue=$(".settingform .sValue").val(); 
			  var enableDate=$(".settingform .enableDate").val();
			  
			  var old_sValue=$(".settingform .old_sValue").val(); 
			  var old_enableDate=$(".settingform .old_enableDate").val();
			  
			  if(old_enableDate>=enableDate){
				  toastr.success("当前值生效时间不能大于预设值生效时间!");
				  return false;
			  }
			  
			  var data={
					  id:id,
					  code:code,
					  comment:comment,
					  sValue:sValue,
					  enableDate:enableDate
					  }
			 
			$.ajax({  type:"post",
		      		   url: ctxPath+'parameterSetting/update',
		      		   contentType:'application/json;charset=utf-8',
		      		   data:JSON.stringify(data),
		      		   success: function(data){
		       		     if(data.status>200){
		       		    	 if(data.status=403){
		       		    		toastr.success(data.msg);
		       		    		window.location.href = ctxPath+"parameterSetting/toUpdate?id="+id;
		       		    	 }else{
			       		    	toastr.warning(data.msg);  
			       		    	setTimeout(function(){
			       		    	window.location.reload();
			       		     	},2000);
		       		    	 }
		       		       }else{
			       		    	toastr.success(data.msg);
			       		     	setTimeout(function(){
			       		    	window.location.href = ctxPath+"parameterSetting/index";
		       		   },2000);
		       	} 				 
	     }});
	
   	});
</script>	
<!--scrolling js-->
<script src="../js/jquery.nicescroll.js"></script>
<script src="../js/scripts.js"></script>
<!--//scrolling js-->

<!-- side nav js -->
<script src='../js/SidebarNav.min.js' type='text/javascript'></script>
<script>
     $('.sidebar-menu').SidebarNav()
   </script>	
<script src="../js/SimpleChart.js"></script>
<script src="../js/bootstrap.js"> </script>	
   
<!--  js -->  
</body>
</html>