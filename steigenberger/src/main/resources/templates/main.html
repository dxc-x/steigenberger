<!DOCTYPE HTML>
<html lang="zh-cn" xmlns:th="http://www.thymeleaf.org">

<head th:fragment="head(title)"   th:with="portUrl=${#httpServletRequest.getScheme() + '://' + #httpServletRequest.getServerName() + ':' + #request.getServerPort()  + #request.getContextPath() + '/'}">
    <meta charset="utf-8"/>
    <title th:text="${title}"></title>
	<meta name="keywords" content="" />
	<base th:href="@{/}">
	<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>

	<!-- Bootstrap Core CSS -->
	<link href="./css/bootstrap.css" rel='stylesheet' type='text/css' />
	
	<!-- Custom CSS -->
	<link href="./css/style.css" rel='stylesheet' type='text/css' />
	
	<!-- font-awesome icons CSS -->
	<link href="./css/font-awesome.css" rel="stylesheet"> 
	<!-- //font-awesome icons CSS-->

 	<!-- js-->
	<script src="./js/jquery-1.11.1.min.js"></script>
	<script src="./js/modernizr.custom.js"></script>

	<!--webfonts-->
	<link href="http://fonts.googleapis.com/css?family=PT+Sans:400,400i,700,700i&amp;subset=cyrillic,cyrillic-ext,latin-ext" rel="stylesheet">
	<!--//webfonts--> 

	<!-- chart -->
	<script src="./js/Chart.js"></script>
	<!-- //chart -->

	<!-- Metis Menu -->
	<script src="./js/metisMenu.min.js"></script>
	<script src="./js/custom.js"></script>
	<link href="./css/custom.css" rel="stylesheet">
	<!--//Metis Menu -->

	<!--pie-chart --><!-- index page sales reviews visitors pie chart -->
	<script src="./js/pie-chart.js" type="text/javascript"></script>
	<link href="./assets/bootstrap.css" rel="stylesheet">
	<script th:src="@{|${portUrl}assets/vendor/toastr/toastr.min.js|}"></script>

	<!-- side nav css file -->
	<link href='./css/SidebarNav.min.css' media='all' rel='stylesheet' type='text/css'/>
	<!-- //side nav css file -->
	<script src="./js/SidebarNav.min.js"></script>
 
	<link  href="./assets/vendor/toastr/toastr.min.css" rel="stylesheet"/>
	<script src="./assets/vendor/toastr/toastr.min.js"></script>
	
	<script type="text/javascript" language="javascript">
	//alert(1);
		var ctxPath  = [[@{/}]];
		var userIdentity;
			$(function () {
				$.ajax({
		            type: "GET",
		            dataType: "json",
		            url: ctxPath+"user/getOperations" ,
		            async:false,
		            success: function (result) {
		            	console.log(result.data);
		            	var user = result.data;
		            	//profile赋值
		            	$("#userId").text("id:"+user.id);
		            	$("#userName").text("userName:"+user.userName);
		            	$("#userIdentity").text("userIdentity:"+user.userIdentity);
		            	var roleList = user.roles;
		            	var roleNames = "";
		            	for(var i=0;i<roleList.length;i++){
		            		if(i==roleList.length-1){
		            			roleNames+=roleList[i].name;
		            		}else{
		            			roleNames+=roleList[i].name+",";
		            		}
		            	}
		            	$("#userRoles").text("userRoles:"+roleNames);
		            	
		            	//判断权限
		            	userIdentity = result.data.userIdentity;
		            	var operationList = result.data.operations;
		            	var operationNames = "";
		            	for(var i=0;i<operationList.length;i++){
		            		operationNames+=operationList[i].name+",";
		            	}
		              	 //alert(operationNames);
		               if(operationNames.indexOf("todo")==-1){
		            	   $('#todo').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("newOrder")==-1){ 
			       			$('#newOrder').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("orderManage")==-1){
			       			$('#orderManage').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("contract")==-1){
			       			$('#contract').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("newSpecial")==-1){
			       			$('#newSpecial').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("report1")==-1){
			       			$('#report1').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("report2")==-1){
			       			$('#report2').attr('href','javascript:void(0);');
			       		}
			       		
			       		if(operationNames.indexOf("report1")==-1&&operationNames.indexOf("report2")==-1){
			       			$('#report').attr('href','javascript:void(0);');
			       		}
			       		
			       		if(operationNames.indexOf("user")==-1){
			       			$('#user').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("permission")==-1){
			       			$('#permission').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("parameterSetting")==-1){
			       			$('#parameterSetting').attr('href','javascript:void(0);');
			       		}
			       		if(operationNames.indexOf("role")==-1){
			       			$('#role').attr('href','javascript:void(0);');
			       		}
			       		
			       		if(operationNames.indexOf("user")==-1&&
			       				operationNames.indexOf("permission")==-1&&
			       				operationNames.indexOf("parameterSetting")==-1&&
			       				operationNames.indexOf("role")==-1
			       				){
			       			
			       			//$('#sys').style="display:none";
			       			$('#sys').attr('style',"display:none");
			       		}
		                
		            },
		            error : function() {
		                //alert("没有查到数据！");
		            }
		        }); 
				
				
			});
			function changeFrameHeight(){
			    var ifm= document.getElementById("myIfram"); 
			    ifm.height=document.documentElement.clientHeight-150;

			}

			/* function show(){
				window.location.href = ctxPath+"user/showUserProfile?userIdentity="+userIdentity; 
			} */
			window.onresize=function(){  
			     changeFrameHeight();  

			} 
	</script>
</head> 
<body class="cbp-spmenu-push">
	<div class="main-content">
		<div class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1" th:replace="menu::menu">	</div>
		<div class="sticky-header header-section " th:replace="head::head">	</div>
		<!-- main content start-->
			<div id="page-wrapper" >
				<iframe id="myIfram"  name="myIfram"  scrolling="yes"  width="100%"  onload="changeFrameHeight()" frameborder="0"></iframe>
			</div>
	</div>		
	<div id="footer" class="container" th:replace="foot::foot"></div>
    
		
	<script src="./js/classie.js"></script>
	<script>
			var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
				showLeftPush = document.getElementById( 'showLeftPush' ),
				body = document.body;
				
			showLeftPush.onclick = function() {
				classie.toggle( this, 'active' );
				classie.toggle( body, 'cbp-spmenu-push-toright' );
				classie.toggle( menuLeft, 'cbp-spmenu-open' );
				disableOther( 'showLeftPush' );
			};
			

			function disableOther( button ) {
				if( button !== 'showLeftPush' ) {
					classie.toggle( showLeftPush, 'disabled' );
				}
			}
	</script>	
	<!--scrolling js-->
	<script src="./js/jquery.nicescroll.js"></script>
	<script src="./js/scripts.js"></script>
	<!--//scrolling js-->

	<!-- side nav js -->
	<script src='./js/SidebarNav.min.js' type='text/javascript'></script>
	<script>
     $('.sidebar-menu').SidebarNav()
  	 </script>	
	<script src="./js/SimpleChart.js"></script>
   	<script src="./js/bootstrap.js"> </script>	
</body>
</html>